# nginx <%= @app %> rack application partial
#
# Generated by Chef for <%= node[:fqdn] %>
# Local modifications will be overwritten.
#

<% if @mount_path.empty? -%>
root                  <%= @docroot %>;
<% end -%>

if (-f $document_root<%= @mount_path %>/system/maintenance.html) {
  rewrite ^(.*)$ <%= @mount_path %>/system/maintenance.html break;
}

<% if @mount_path.empty? -%>
passenger_enabled     on;
rack_env              <%= @rack_env %>;
<% else -%>
location <%= @mount_path %> {
  passenger_enabled   on;
  passenger_base_uri  <%= @mount_path %>
  rack_env            <%= @rack_env %>;
}
<% end -%>
